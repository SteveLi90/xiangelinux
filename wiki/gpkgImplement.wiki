#labels Featured
#用户接口gpkg的实现方案

= 0.简介 =

本文介绍了弦歌Linux包管理系统gpkg的实现方案。关于gpkg的功能说明，请参考文档[xgpkg]


= 1.下载软件包=

下载软件包通过gpkg -d 命令, 例如 gpkg -d autoconf. <br>
首先，gpkg需要知道autoconf软件包的下载地址(URL), 和校验码/大小信息。这些信息每个软件包都不同，所以每个软件包都需要一个脚本文件，描述软件包相关的信息。假如autoconf对应的脚本文件为autoconf.xgp, 下载的流程如下

1.1 得到软件包对应的脚本文件autoconf.xgp,失败则返回1.
1.2 调用脚本文件获取待下载文件的URL/MD5Sum/Size信息
1.3 在本地检查文件是否已下载，是的话转1.5
1.4 下载文件到本地，失败后重试。重试次数超过5,失败返回2。
1.5 校验MD5Sum和文件大小，失败后重新下载，重试次数超过5， 返回3
1.6 重复直至所有文件下载完毕，返回0表示成功。

= 2. 软件包脚本文件=

