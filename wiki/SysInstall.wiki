#labels Featured
#安装弦歌Linux

= 0.简介 =

本文介绍了安装弦歌Linux的步骤。


= 1.安装需求 =

||硬件需求||任何Linux支持的硬件系统，目前只在PC机上测试<br>5G以上的硬盘空间<br>128MB以上的内存||
    

= 2.安装方式 =
弦歌Linux支持2种安装方式: 手动安装和自动脚本安装。无论何种方式，都调用弦歌的包管理系统gpkg, 请参见文档[xgpkg].

= 3.手动安装 =
手动安装即通过手动的方式安装所有软件包，如先调用gpkg -i linux-header 安装所有Linux头文件， 再调用gpkg -i glibc 安装C库， 再调用gpkg -i bin-utils安装二进制工具链。安装的步骤和LFS手册类似，只是细节交给gpkg处理。

具体步骤如下:
    * 3.1 格式化分区，挂载到/mnt/xiange，即工作目录。
    * 3.2 编译工具链
        * 3.2.1 直接下载工具链到/tools
        * 3.2.2 下载编辑脚本，从头生成工具链
           运行工具链脚本，自动生成工具链，放在/mnt/xiange/tools目录下，内有installed.log, 表示tools目录都安装了什么工具。
    * 3.3 更新编译脚本库
           运行tools目录下的gpkg --sync /mnt/xiange, 会自动更新编译脚本库
    * 3.4 使用chroot转到工作目录: chroot /mnt/xiange /tools/bin/bash (注意先挂载proc,sysfs,和dev，并拷贝/etc/resolv.conf 到/mnt/xiange/etc目录)
    * 3.5 这时可以自由运行gpkg, 安装需要的软件包。
        # gpkg -i baselayout 创建根目录，包括/dev,/sys,/usr,/bin,/sbin等等
        # gpkg -i linux-headers 安装头文件
        # 每装完一个包，都可以用qpkg 查看安装信息，可以对系统了如指掌。
        # 继续安装，知道整个系统可以脱离/tools直接运行。
    * 3.6 设置密码，修改fstab, 编译内核，安装GRUB, 重新启动。



= 4.自动脚本安装 =
自动脚本安装通过脚本文件，自动调用gpkg安装所需软件包。自动安装时支持4中安装情景，称为情景0(又称Stage0), 情景1, 情景2, 情景3. 介绍如下:

||情景||简介||
||Stage0||完全从0开始安装，只需下载安装脚本，指定安装的目的分区(或目的目录),运行脚本即可。<br>脚本自动下载所需软件包，从头构建工具链，构建根系统，安装软件包，直至系统完成。||
||Stage1||比Stage0简化些，不需在本地构建工具链。预下载内容包括工具链和安装脚本。<br>指定安装的目的分区(或目的目录),运行脚本。<br>脚本自动下载所需软件包，构建根系统，安装软件包，直至系统完成。||
||Stage2||比Stage1简化些，不需要额外的工具链。预下载内容包括跟文件系统，已预装好编译环境和包管理系统。<br>用户只需要在此基础上, 调用gpkg安装自己喜欢的软件包即可。||
||Stage3||Stage2的扩充，包括X系统, gtk2, qt4, fvwm, firefox等预装软件包。||

用户可以根据需求，从任何一种情景开始安装。情景0和情景1需要编译构建根系统，情景2和情景3解压后直接得到根系统。
根系统准备好后，编译内核，安装Grub, 创建用户，设置密码，然后重新启动即可。